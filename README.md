# ICS-Fuzz
Fuzz for ICS.



先从简单点的协议fuzz开始写起。

目标：
- 实现更丰富的变异（增加变长变异etc。。）
- 实现更丰富的初始源协议数据（比如把modbus所有功能码都覆盖）
- 增强fuzz的鲁棒性，支持更丰富参数选择，能够较好的回溯定位。
- fuzz的时间间隔自学习修改。
- 根据回显包/时间/速度，进行针对性变异。（？瞎想的）

对于实现架构，想了想，还是用python最方便好用的模块来写，类写起来麻烦。。

为什么不用C？没必要。因为不涉及插桩，纯黑盒，还是协议fuzz，C和python差距真不大，而python写起来远比C简单。

## TODO

- [ ] modbus功能码完善
- [x] 异常处理添加（直接pass……2333。。。）
- [ ] 交叉功能码fuzz实现
- [x] 多字节的变异
- [x] map存hash判重


## Improvement
用AFL-NET跑了跑，感觉也没啥特别好用的。。 还是得把`-D`参数调大，才能fuzz单条报文，而不是因为发包过快导致的DoS。。。
这可能是fuzz协议，特别是国产PLC这些速率控制做的不够完善的一个通病吧。。。

可以学习AFL-NET的思路，增加变异的种类，还可以考虑加入dictionary的针对性变异，还有比如多个字节的flip……